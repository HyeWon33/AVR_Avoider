# [AVR] Avoider


## 작동 환경
- Atmel Studio 7.0
- Atmega128
 
<img src = "https://user-images.githubusercontent.com/52944554/121841214-d7e5c180-cd18-11eb-8605-160ea5ca7e9b.PNG" width="20%">



## 사용한 것들
<img src="https://user-images.githubusercontent.com/52944554/121841664-be914500-cd19-11eb-95f7-88e48b52d0b8.png" width = "50%">

- 스텝 모터
- 스텝모터
- 초음파센서 
- 적외선센서
- LED

## 작동 설명
- 직진하다가 정면에서는 초음파센서값을 받고 측면에서는 적외선 센서값을 받아서 벽에 부딪치지 않고 회전하게 하였습니다. 직진할 때는 LED가 전부 ON이 되고 좌회전을 할 때는 1~4번 LED만 ON이 됩니다.
- 스텝모터를 작동할 때 고속 PWM모드를 사용했습니다.

## 작동 움짤
![ezgif com-video-to-gif (2)](https://user-images.githubusercontent.com/52944554/121842637-b20dec00-cd1b-11eb-9fcf-3ed1f7809744.gif)

## 단점
- 속도가 느립니다. 조금만 더 손보면 작동을 더 정교하게 할 수 있을 거 같습니다.
- 적외선 센서를 사용했습니다. 아트메가에 16비트 타이머/카운터가 1,3번 2개라서 1번은 비교일치를 하며 작동하기 위해서 쓰이고 3번은 초음파 센서를 위해 사용했습니다. 그러면서 측면 타이머/카운터를 위한 타이머/카운터가 없어서 값이 불안정하고 정교하지 않은거 같은 적외선 센서를 사용했습니다.

## 장점
- 센서를 2개 사용해서 부드럽게 움직입니다.



## ...
2주 동안 계속은 아니지만 틈틈이 공부하면서 만들었습니다. 첫 번째 주에는 PWM모드를 써야 하는데 (아니 솔직히 지금도 왜 스텝 모터는 비교일치를 쓰는지 모르겠습니다) CTC모드를 작성하면서 헛삽질을 했습니다. 둘째 주에는 T/C를 분리해서 써야 한다고 생각도 못했습니다... 그래서 삐꺽삐꺽 움직여서 그냥 넘어가려다가 교수님한테 질문해서 알게 되었습니다... 너무 힘들었습니다. (머리에서 흰 머리를 보았습..) 이 어보이더를 위해서 넣고 싶었던 기능이 많이 있었습니다. 예를 들어 스피커, LCD, 소리 감지하는 센서.. 등등 그러나 스텝모터를 작동하기 위해 넣지 비교일치 인터럽트를 쓰면서 사용하지 못했습니다. 비교일치가 너무 어려웠습니다. 잘 이해가 안 가서 계속 공부하고 보면서 이해는 했지만 감이 오지 않았습니다... 아무튼, 이런 와중에 열심히 만들어 봤지만 ISR에서 지금 받는 초음파 값 출력하는 거 하나 썼다고 움직임이 이상하고 그랬습니다... 그러다 보니까 일단 잘 움직이게라도 해보자고 하다가 많은 기능이 빠졌습니다. 3주 전에 시작했더라면 더 괜찮았을까 후회도 되었지만 시험 기간에 틈틈이 나름 많은 시간을 투자해서 열심히 만든 것 같습니다. 
